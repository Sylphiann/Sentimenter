{% extends "base.html" %}
{% load static %}

{% block content %}
    <h1>Admin Tools</h1>

    {% if success %}
        <div class="alert alert-success" style="padding: 10px; background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; margin-bottom: 15px;">
            {{ success }}
        </div>
    {% endif %}

    {% if error %}
        <div class="alert alert-danger" style="padding: 10px; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; margin-bottom: 15px;">
            {{ error }}
        </div>
    {% endif %}

    <div style="display: flex; gap: 30px;">
        <div style="flex: 1; border: 1px solid #ccc; padding: 20px; border-radius: 5px;">
            <h2>Import Sentences (.txt)</h2>
            <p>Upload a .txt file where each line is a new sentence instance. Sentiment will default to 'No Relation'.</p>
            <form method="post" enctype="multipart/form-data" action="{% url 'admin-sentence' %}">
                {% csrf_token %}
                <input type="hidden" name="action" value="import_sentences">
                <input type="file" name="sentences_file" accept=".txt" required style="margin-bottom: 10px;">
                <br>
                <button type="submit" class="button" style="background-color: #007bff; color: white; padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer;">
                    Import Sentences
                </button>
            </form>
        </div>

        <div style="flex: 1; border: 1px solid #ccc; padding: 20px; border-radius: 5px;">
            <h2>Export Sentences (JSON)</h2>
            <p>Download all existing sentences as a JSON file.</p>
            <form method="post" action="{% url 'admin-sentence' %}">
                {% csrf_token %}
                <input type="hidden" name="action" value="export_sentences">
                <button type="submit" class="button" style="background-color: #28a745; color: white; padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer;">
                    Export Sentences
                </button>
            </form>
        </div>

        <div style="flex: 1; border: 1px solid #ccc; padding: 20px; border-radius: 5px;">
            <h2>Delete Sentences (JSON)</h2>
            <p>Deletes all existing sentences.</p>
            <form method="post" action="{% url 'admin-sentence' %}">
                {% csrf_token %}
                <input type="hidden" name="action" value="delete_sentences">
                <button type="submit" class="delete-button" style="background-color: #ee6565; color: white; padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer;" onclick="return confirm('Are you absolutely sure you want to delete ALL model instances? This action cannot be undone.');"> Delete Sentences
                </button>
            </form>
        </div>
    </div>

    {% if sentence_list %}
    <hr style="margin-top: 30px; margin-bottom: 30px;">
    <h2>Imported Sentences ({{ sentence_list|length }})</h2>
    <ul style="list-style-type: disc; padding-left: 20px;">
        {% for sentence_id, sentence_text in sentence_list %}
        <li style="
                margin-bottom: 15px; 
                display: flex;
                align-items: flex-start; /* CHANGE THIS LINE from center to flex-start */
                padding-right: 20px;
            ">
                
                <form method="post" action="{% url 'admin-sentence' %}" style="flex-shrink: 0; margin-right: 10px;"> 
                    {% csrf_token %}
                    <input type="hidden" name="action" value="delete_a_sentence">
                    <input type="hidden" name="sentence_id" value="{{ sentence_id }}"> 
                    
                    <button type="submit" class="delete-button" 
                    style="
                        background-color: #e74c3c;
                        color: white;
                        border: 1px solid #c0392b;
                        padding: 5px 10px;
                        border-radius: 4px;
                        cursor: pointer;
                        font-weight: bold;
                    "
                    onclick="return confirm('Are you absolutely sure you want to delete this sentence? This action cannot be undone.');"> 
                        DEL
                    </button>
                </form>
                
                <span style="flex-grow: 1; align-self: center;">
                    {{ sentence_text }}
                </span>
                
            </li>
        {% endfor %}
    </ul>
    {% endif %}

{% endblock %}