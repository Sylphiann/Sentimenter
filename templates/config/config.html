{% extends "base.html" %}
{% load static %}

{% block page_css %}
    <link rel="stylesheet" href="{% static 'css/config/config.css' %}">
{% endblock %}

{% block content %}
    <h1>Admin Tools</h1>

    {% if success %}
        <div class="alert admin-alert-success">
            {{ success }}
        </div>
    {% endif %}

    {% if error %}
        <div class="alert admin-alert-danger">
            {{ error }}
        </div>
    {% endif %}

    <div class="admin-tools-container">
        <div class="admin-tool-card">
            <h2>Import Sentences (.txt)</h2>
            <p>Upload a .txt file where each line is a new sentence instance. Sentiment will default to 'No Relation'.</p>
            <form method="post" enctype="multipart/form-data" action="{% url 'admin-sentence' %}">
                {% csrf_token %}
                <input type="hidden" name="action" value="import_sentences">
                <input type="file" name="sentences_file" accept=".txt" required class="file-input">
                <br>
                <button type="submit" class="button primary-button">
                    Import Sentences
                </button>
            </form>
        </div>

        <div class="admin-tool-card">
            <h2>Export Sentences (JSON)</h2>
            <p>Download all existing sentences as a JSON file.</p>
            <form method="post" action="{% url 'admin-sentence' %}">
                {% csrf_token %}
                <input type="hidden" name="action" value="export_sentences">
                <button type="submit" class="button success-button">
                    Export Sentences
                </button>
            </form>
        </div>

        <div class="admin-tool-card">
            <h2>Delete Sentences (JSON)</h2>
            <p>Deletes all existing sentences.</p>
            <form method="post" action="{% url 'admin-sentence' %}">
                {% csrf_token %}
                <input type="hidden" name="action" value="delete_sentences">
                <button type="submit" class="button danger-button" onclick="return confirm('Are you absolutely sure you want to delete ALL model instances? This action cannot be undone.');"> 
                    Delete Sentences
                </button>
            </form>
        </div>
    </div>

    {% if sentence_list %}
    <hr class="sentence-list-divider">
    <h2>Imported Sentences ({{ sentence_list|length }})</h2>
    <ul class="sentence-list">
        {% for sentence_id, sentence_text in sentence_list %}
        <li class="sentence-item">
                
                <form method="post" action="{% url 'admin-sentence' %}" class="delete-form"> 
                    {% csrf_token %}
                    <input type="hidden" name="action" value="delete_a_sentence">
                    <input type="hidden" name="sentence_id" value="{{ sentence_id }}"> 
                    
                    <button type="submit" class="delete-button small-delete-button" 
                    onclick="return confirm('Are you absolutely sure you want to delete this sentence? This action cannot be undone.');"> 
                        DEL
                    </button>
                </form>
                
                <span class="sentence-text">
                    {{ sentence_text }}
                </span>
                
        </li>
        {% endfor %}
    </ul>
    {% endif %}

{% endblock %}